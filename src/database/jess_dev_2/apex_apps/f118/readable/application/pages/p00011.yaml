---
# ====== Page: Update or Delete Affects ======================
id: 11
identification: 
  name: Update or Delete Affects
  alias: UPDATE-OR-DELETE-AFFECTS
  title: Update or Delete Affects
  page-group: Administration # 8949833037355592644

appearance: 
  page-mode: Normal
  page-template: Theme Default
  template-options: 
  - '#DEFAULT#'

navigation-menu: 
  override-user-interface-level: false

navigation: 
  cursor-focus: First item on page
  warn-on-unsaved-changes: false

javascript: 
  function-and-global-variable-declaration: var htmldb_delete_message='"DELETE_CONFIRM_MSG"';

security: 
  authorization-scheme: CONTRIBUTION RIGHTS # 3264368700663348877
  authentication: Page Requires Authentication
  deep-linking: Application Default
  page-access-protection: Arguments Must Have Checksum
  form-auto-complete: Off
  browser-cache: Application Default

session-management: 
  rejoin-sessions: Application Default

advanced: 
  enable-duplicate-page-submissions: Yes - Enable page to be re-posted
  reload-on-submit: Always

server-cache: 
  caching: Disabled

help: 
  help-text: You will only see this page when you're updating a recurring event. Choose whether or not the changes you made on the previous page applies to all events, future events, or only the initial event. Click the <strong>Apply Changes</strong> button to save your changes. Click the <strong>Cancel</strong> button toleave this page and not make any changes to your event(s).

regions: 
- # ====== Region: Update Event(s) =============================
  id: 7418252646888090880
  identification: 
    name: Update Event(s)
    type: Static Content

  layout: 
    sequence: 10
    parent-region: No Parent
    slot: BODY
    start-new-layout: false
    start-new-row: true
    column: Automatic
    new-column: true
    column-span: Automatic

  appearance: 
    template: Standard
    template-options: 
    - '#DEFAULT#'
    - t-Region--hideHeader js-addHiddenHeadingRoleDesc
    - t-Region--hiddenOverflow
    render-components: Above Content

  accessibility: 
    use-landmark: true
    landmark-type: Template Default

  advanced: 
    region-display-selector: false
    exclude-title-from-translation: false

  server-side-condition: 
    type: Item != Value
    item: P11_REQUEST_TYPE
    value: D

  customization: 
    customizable: Not Customizable By End Users

  attributes: 
    settings: 
      output-as: HTML
      expand-shortcuts: false

- # ====== Region: Remove Event(s) =============================
  id: 7418262620138102121
  identification: 
    name: Remove Event(s)
    type: Static Content

  layout: 
    sequence: 20
    parent-region: No Parent
    slot: BODY
    start-new-layout: false
    start-new-row: true
    column: Automatic
    new-column: true
    column-span: Automatic

  appearance: 
    template: Standard
    template-options: 
    - '#DEFAULT#'
    - t-Region--hideHeader js-addHiddenHeadingRoleDesc
    - t-Region--hiddenOverflow
    render-components: Above Content

  accessibility: 
    use-landmark: true
    landmark-type: Template Default

  advanced: 
    region-display-selector: false
    exclude-title-from-translation: false

  server-side-condition: 
    type: Item = Value
    item: P11_REQUEST_TYPE
    value: D

  customization: 
    customizable: Not Customizable By End Users

  attributes: 
    settings: 
      output-as: HTML
      expand-shortcuts: false

- # ====== Region: Scope =======================================
  id: 8530413478056638507
  identification: 
    name: Scope
    type: Static Content

  layout: 
    sequence: 30
    parent-region: Update Event(s) # 7418252646888090880
    slot: SUB_REGIONS
    start-new-layout: false
    start-new-row: true
    column: Automatic
    new-column: true
    column-span: Automatic

  appearance: 
    template: Standard
    template-options: 
    - '#DEFAULT#'
    - t-Region--hideHeader js-addHiddenHeadingRoleDesc
    - t-Region--scrollBody
    render-components: Above Content

  accessibility: 
    use-landmark: true
    landmark-type: Template Default

  advanced: 
    region-display-selector: false
    exclude-title-from-translation: false

  server-side-condition: 
    type: Item != Value
    item: P11_REQUEST_TYPE
    value: D

  customization: 
    customizable: Not Customizable By End Users

  attributes: 
    settings: 
      output-as: HTML
      expand-shortcuts: false

- # ====== Region: breadcrumb ==================================
  id: 8530420676469638514
  identification: 
    name: breadcrumb
    type: Breadcrumb

  source: 
    breadcrumb: ' Breadcrumb' # 8949803322316567820

  layout: 
    sequence: 60
    parent-region: No Parent
    slot: REGION_POSITION_01
    start-new-layout: false
    start-new-row: true
    column: Automatic
    new-column: true
    column-span: Automatic

  appearance: 
    template: Title Bar
    template-options: 
    - '#DEFAULT#'
    - t-BreadcrumbRegion--useBreadcrumbTitle
    render-components: Above Content

  accessibility: 
    use-landmark: true
    landmark-type: Template Default

  advanced: 
    region-display-selector: false
    exclude-title-from-translation: false

  customization: 
    customizable: Not Customizable By End Users

  attributes: 
    appearance: 
      breadcrumb-template: Breadcrumb
      template-options: 
      - '#DEFAULT#'

- # ====== Region: Associated Events ===========================
  id: 8532376265021860787
  identification: 
    name: Associated Events
    type: Classic Report

  source: 
    location: Local Database
    type: SQL Query
    sql-query: |
      select to_char(EVENT_DATE_TIME,'&APP_DATE_FORMAT.') ||
                case when event_id = :P10_EVENT_ID
                     then ' *'
                     end event_date,
             event_name,
             to_char(EVENT_DATE_TIME,'&APP_TIME_FORMAT.') || ' - ' ||
             to_char(to_date(to_char(EVENT_DATE_TIME,
                             '&APP_DATE_FORMAT.'||'&APP_TIME_FORMAT.'),
                     '&APP_DATE_FORMAT.'||'&APP_TIME_FORMAT.')
                      +(duration/24),'&APP_TIME_FORMAT.') ||
             ' (' ||
             case when duration = .5 then '30 mins'
                  when duration = 1 then '1 hr'
                  when duration > 1 then to_char(duration) || ' hrs'
                  end ||
             ')' event_time
        from EBA_CA_EVENTS
       where series_id = :P10_SERIES_ID
       order by EVENT_DATE_TIME

  order-by: 
    type: None

  layout: 
    sequence: 50
    parent-region: Update Event(s) # 7418252646888090880
    slot: SUB_REGIONS
    start-new-layout: false
    start-new-row: true
    column: Automatic
    new-column: true
    column-span: Automatic

  appearance: 
    template: Standard
    template-options: 
    - '#DEFAULT#'
    - t-Region--noPadding
    - t-Region--scrollBody
    render-components: Above Content

  accessibility: 
    use-landmark: true
    landmark-type: Template Default

  advanced: 
    region-display-selector: false
    exclude-title-from-translation: false

  header-and-footer: 
    footer-text: '* selected event'

  server-cache: 
    caching: Disabled

  customization: 
    customizable: Not Customizable By End Users

  attributes: 
    layout: 
      number-of-rows-type: Static Value
      number-of-rows: 15

    appearance: 
      template-type: Theme
      template: Standard
      template-options: 
      - '#DEFAULT#'
      - t-Report--stretch
      - t-Report--altRowsDefault
      - t-Report--rowHighlight
      - t-Report--inline
      show-null-values-as: ' - '

    pagination: 
      type: Row Ranges X to Y (with next and previous links)
      display-position: Bottom - Right
      partial-page-refresh: true

    performance: 
      lazy-loading: false
      maximum-rows-to-process: 500

    messages: 
      when-no-data-found: No associated events found.

    break-formatting: 
      break-columns: No Break

    advanced: 
      strip-html: true
      sort-nulls: Last

    heading: 
      type: Custom Headings

    download: 
      csv-export-enabled: false

    printing: 
      enabled: false

  columns: 
  - # ====== Column: EVENT_DATE ==================================
    id: 8532376575835860796
    identification: 
      column-name: EVENT_DATE
      type: Plain Text

    heading: 
      heading: Date
      alignment: start

    layout: 
      sequence: 1
      column-alignment: start

    accessibility: 
      value-identifies-row: false

    sorting: 
      sortable: false

    export-/-printing: 
      include-in-export-/-print: true

    advanced: 
      compute-sum: false

    ui-defaults-reference: 
      table-owner: Parsing Schema

    security: 
      escape-special-characters: true

  - # ====== Column: EVENT_NAME ==================================
    id: 8532376686192860799
    identification: 
      column-name: EVENT_NAME
      type: Plain Text

    heading: 
      heading: Name
      alignment: start

    layout: 
      sequence: 2
      column-alignment: start

    accessibility: 
      value-identifies-row: false

    sorting: 
      sortable: false

    export-/-printing: 
      include-in-export-/-print: true

    advanced: 
      compute-sum: false

    ui-defaults-reference: 
      table-owner: Parsing Schema

    security: 
      escape-special-characters: true

  - # ====== Column: EVENT_TIME ==================================
    id: 8532376779199860799
    identification: 
      column-name: EVENT_TIME
      type: Plain Text

    heading: 
      heading: Time
      alignment: start

    layout: 
      sequence: 3
      column-alignment: start

    accessibility: 
      value-identifies-row: false

    sorting: 
      sortable: false

    export-/-printing: 
      include-in-export-/-print: true

    advanced: 
      compute-sum: false

    ui-defaults-reference: 
      table-owner: Parsing Schema

    security: 
      escape-special-characters: true

page-items: 
- # ====== Page Item: P11_UPD_REQUEST ==========================
  id: 8530413693965638507
  identification: 
    name: P11_UPD_REQUEST
    type: Radio Group

  label: 
    label: 'Updates Affect:'
    alignment: Left

  settings: 
    number-of-columns: 3
    page-action-on-selection: None

  layout: 
    sequence: 20
    region: Scope # 8530413478056638507
    slot: BODY
    alignment: Left
    start-new-layout: false
    start-new-row: true
    column: Automatic
    new-column: true
    column-span: Automatic
    label-column-span: Page Template Default

  appearance: 
    template: Required
    template-options: 
    - '#DEFAULT#'

  validation: 
    value-required: true

  list-of-values: 
    type: Shared Component
    list-of-values: UPD_REQUEST_AFO # 9175601920653508973
    display-extra-values: false
    display-null-value: false

  advanced: 
    warn-on-unsaved-changes: Page Default

  source: 
    type: Null
    used: Only when current value in session state is null

  session-state: 
    storage: Per Session (Persistent)

  security: 
    session-state-protection: Unrestricted
    store-value-encrypted-in-session-state: true
    escape-special-characters: true
    restricted-characters: All characters can be saved.

  help: 
    help-text: Identify which events you want this update to affect.

- # ====== Page Item: P11_DEL_REQUEST ==========================
  id: 8530432688992656274
  identification: 
    name: P11_DEL_REQUEST
    type: Radio Group

  label: 
    label: 'Delete Affects:'
    alignment: Left

  settings: 
    number-of-columns: 3
    page-action-on-selection: None

  layout: 
    sequence: 30
    region: Remove Event(s) # 7418262620138102121
    slot: BODY
    alignment: Left
    start-new-layout: false
    start-new-row: true
    column: Automatic
    new-column: true
    column-span: Automatic
    label-column-span: Page Template Default

  appearance: 
    template: Required
    template-options: 
    - '#DEFAULT#'

  validation: 
    value-required: true

  list-of-values: 
    type: Shared Component
    list-of-values: UPD_REQUEST_AFO # 9175601920653508973
    display-extra-values: false
    display-null-value: false

  advanced: 
    warn-on-unsaved-changes: Page Default

  source: 
    type: Null
    used: Only when current value in session state is null

  default: 
    type: Static
    static-value: A

  session-state: 
    storage: Per Session (Persistent)

  security: 
    session-state-protection: Unrestricted
    store-value-encrypted-in-session-state: true
    escape-special-characters: true
    restricted-characters: All characters can be saved.

  help: 
    help-text: Identify which events you want this delete to affect.

- # ====== Page Item: P11_REQUEST_TYPE =========================
  id: 8530434092586666756
  identification: 
    name: P11_REQUEST_TYPE
    type: Hidden

  settings: 
    value-protected: true

  layout: 
    sequence: 10
    region: Scope # 8530413478056638507
    slot: BODY

  advanced: 
    warn-on-unsaved-changes: Page Default

  source: 
    type: Null
    used: Only when current value in session state is null

  session-state: 
    data-type: VARCHAR2
    storage: Per Session (Persistent)

  security: 
    session-state-protection: Checksum Required - Session Level
    store-value-encrypted-in-session-state: true
    restricted-characters: All characters can be saved.

buttons: 
- # ====== Button: CANCEL ======================================
  id: 8530414087866638508
  identification: 
    button-name: CANCEL
    label: Cancel

  layout: 
    sequence: 10
    region: breadcrumb # 8530420676469638514
    slot: CLOSE
    start-new-layout: false
    start-new-row: true
    column: Automatic
    new-column: true
    column-span: Automatic

  appearance: 
    button-template: Text
    hot: false
    template-options: 
    - '#DEFAULT#'

  behavior: 
    action: Redirect to Page in this Application
    target: 
      url: 'f?p=&APP_ID.:&LAST_VIEW.:&SESSION.::&DEBUG.:::'
      page: '&LAST_VIEW.'

    warn-on-unsaved-changes: Do Not Check

- # ====== Button: SAVE ========================================
  id: 8530414275783638509
  identification: 
    button-name: SAVE
    label: Apply Changes

  layout: 
    sequence: 20
    region: breadcrumb # 8530420676469638514
    slot: CREATE
    start-new-layout: false
    start-new-row: true
    column: Automatic
    new-column: true
    column-span: Automatic

  appearance: 
    button-template: Text
    hot: true
    template-options: 
    - '#DEFAULT#'

  behavior: 
    action: Submit Page
    execute-validations: true
    show-processing: false
    warn-on-unsaved-changes: Do Not Check

  server-side-condition: 
    type: Item != Value
    item: P11_REQUEST_TYPE
    value: D

- # ====== Button: DELETE ======================================
  id: 8530414674414638509
  identification: 
    button-name: DELETE
    label: Delete

  layout: 
    sequence: 40
    region: breadcrumb # 8530420676469638514
    slot: DELETE
    start-new-layout: false
    start-new-row: true
    column: Automatic
    new-column: true
    column-span: Automatic

  appearance: 
    button-template: Text
    hot: true
    template-options: 
    - '#DEFAULT#'
    - t-Button--danger
    - t-Button--simple

  behavior: 
    action: Submit Page
    execute-validations: false
    show-processing: false
    warn-on-unsaved-changes: Do Not Check

  server-side-condition: 
    type: Item = Value
    item: P11_REQUEST_TYPE
    value: D

processes: 
- # ====== Process: Update =====================================
  id: 8530422194754638521
  identification: 
    name: Update
    type: Execute Code
    execution-chain: None

  source: 
    location: Local Database
    language: PL/SQL
    pl/sql-code: |
      declare
         l_type_id         number;
         l_new_event_type  varchar2(60);
         l_display_time    varchar2(1);
      begin
      
      if :P10_TYPE_ID = '-1' then
         l_type_id        := null;
         l_new_event_type := :P10_NEW_EVENT_TYPE;
      else
         l_type_id        := :P10_TYPE_ID;
         l_new_event_type := null;
      end if;
      
      if :P10_SUPPRESS_TIME = 'Y' then
         l_display_time := 'N';
      else
         l_display_time := 'Y';
      end if;
      
      EBA_ca_api.update_event (
         p_event_id        => :P10_EVENT_ID,
         p_event_name      => :P10_EVENT_NAME,
         p_type_id         => l_type_id,
         p_calendar_id     => :P10_CALENDAR_ID,
         p_new_event_type  => l_new_event_type,
         p_new_color_pref_id  => :P10_NEW_COLOR_PREF_ID,
         p_new_internal_yn    => :P10_NEW_INTERNAL_YN,
         p_event_date_time => to_date(:P10_EVENT_DATE_D||:P10_EVENT_START_TIME_D,
                                     '&APP_DATE_FORMAT.&APP_TIME_FORMAT.'),
         p_duration        => :P10_DURATION,
         p_event_desc      => :P10_EVENT_DESC,
         p_contact_person  => :P10_CONTACT_PERSON,
         p_contact_email   => :P10_CONTACT_EMAIL,
         p_display_time    => l_display_time,
         p_location        => :P10_LOCATION,
         p_link_name_1     => :P10_LINK_NAME_1,
         p_link_url_1      => :P10_LINK_URL_1,
         p_link_name_2     => :P10_LINK_NAME_2,
         p_link_url_2      => :P10_LINK_URL_2,
         p_link_name_3     => :P10_LINK_NAME_3,
         p_link_url_3      => :P10_LINK_URL_3,
         --
         p_recur_flag      => :P10_RECUR_FLAG,
         p_recur_freq      => :P10_RECUR_FREQ,
         p_recur_end_date  => to_date(:P10_RECUR_END_DATE||:P10_EVENT_START_TIME_D,
                                     '&APP_DATE_FORMAT.&APP_TIME_FORMAT.'), 
         --
         p_update_request => :P11_UPD_REQUEST,
         p_tags           => :P10_TAGS );
      
      end;

  execution: 
    sequence: 10
    point: Processing
    run-process: Once Per Page Visit (default)

  success-message: 
    success-message: Event(s) updated.

  error: 
    error-message: Error updating Event(s).
    display-location: On Error Page

  server-side-condition: 
    when-button-pressed: SAVE # 8530414275783638509

- # ====== Process: Delete =====================================
  id: 8530422396997638521
  identification: 
    name: Delete
    type: Execute Code
    execution-chain: None

  source: 
    location: Local Database
    language: PL/SQL
    pl/sql-code: |
      EBA_ca_api.delete_event (
         p_event_id       => :P10_EVENT_ID,
         --
         p_delete_request => :P11_DEL_REQUEST );

  execution: 
    sequence: 20
    point: Processing
    run-process: Once Per Page Visit (default)

  success-message: 
    success-message: Event(s) deleted.

  error: 
    error-message: Error deleting Event(s).
    display-location: On Error Page

  server-side-condition: 
    when-button-pressed: DELETE # 8530414674414638509

branches: 
- # ====== Branch: Go Home =====================================
  id: 3160412624610205780
  identification: 
    name: Go Home

  execution: 
    sequence: 20
    point: After Processing

  behavior: 
    type: Page or URL (Redirect)
    target: 
      url: 'f?p=&APP_ID.:1:&SESSION.::&DEBUG.:RP::&success_msg=#SUCCESS_MSG#'
      page: 1 # Home
      clear-cache: RP

  server-side-condition: 
    when-button-pressed: DELETE # 8530414674414638509

- # ====== Branch: Go To Home ==================================
  id: 8530424687422638529
  identification: 
    name: Go To Home

  execution: 
    sequence: 10
    point: After Processing

  behavior: 
    type: Page or URL (Redirect)
    target: 
      url: 'f?p=&APP_ID.:1:&SESSION.::&DEBUG.:::&success_msg=#SUCCESS_MSG#'
      page: 1 # Home

    save-state-before-branching: true

  server-side-condition: 
    when-button-pressed: SAVE # 8530414275783638509

